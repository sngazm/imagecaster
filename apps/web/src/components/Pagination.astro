---
interface Props {
  currentPage: number;
  totalPages: number;
  basePath?: string;
}

const { currentPage, totalPages, basePath = "" } = Astro.props;

function getPageUrl(page: number): string {
  if (page === 1) {
    return basePath || "/";
  }
  return `${basePath}/page/${page}`;
}
---

{totalPages > 1 && (
  <nav class="mt-8 flex items-center justify-center gap-2" aria-label="ページネーション">
    {currentPage > 1 && (
      <a
        href={getPageUrl(currentPage - 1)}
        class="inline-flex items-center gap-1 rounded-lg border border-zinc-200 bg-white px-3 py-2 text-sm font-medium text-zinc-700 hover:bg-zinc-50 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:hover:bg-zinc-700"
        aria-label="前のページ"
      >
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        前へ
      </a>
    )}

    <div class="flex items-center gap-1">
      {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => {
        const isCurrentPage = page === currentPage;
        const showPage = page === 1 || page === totalPages || Math.abs(page - currentPage) <= 1;
        const showEllipsis = !showPage && (page === 2 || page === totalPages - 1);

        if (showEllipsis) {
          return <span class="px-2 text-zinc-400">...</span>;
        }

        if (!showPage) {
          return null;
        }

        return (
          <a
            href={getPageUrl(page)}
            class={`inline-flex h-9 w-9 items-center justify-center rounded-lg text-sm font-medium transition-colors ${
              isCurrentPage
                ? "bg-blue-600 text-white"
                : "border border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:hover:bg-zinc-700"
            }`}
            aria-current={isCurrentPage ? "page" : undefined}
          >
            {page}
          </a>
        );
      })}
    </div>

    {currentPage < totalPages && (
      <a
        href={getPageUrl(currentPage + 1)}
        class="inline-flex items-center gap-1 rounded-lg border border-zinc-200 bg-white px-3 py-2 text-sm font-medium text-zinc-700 hover:bg-zinc-50 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:hover:bg-zinc-700"
        aria-label="次のページ"
      >
        次へ
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    )}
  </nav>
)}
