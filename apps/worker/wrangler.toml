name = "imagecaster-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

routes = [
  { pattern = "caster.image.club/api/*", zone_name = "image.club" },
]

workers_dev = true

# 環境変数
# Cloudflare Dashboard (Workers & Pages > Settings > Variables) で設定するか、
# ローカル開発では .dev.vars.example を .dev.vars にコピーして使用
#
# 必須の環境変数:
# - PODCAST_TITLE: 番組名
# - WEBSITE_URL: 公開サイトURL
# - R2_ACCOUNT_ID: CloudflareアカウントID
# - R2_BUCKET_NAME: R2バケット名
# - R2_PUBLIC_URL: R2公開URL
# - CF_ACCESS_TEAM_DOMAIN: Cloudflare Accessチームドメイン (例: yourteam.cloudflareaccess.com)
# - CF_ACCESS_AUD: Cloudflare AccessアプリケーションのAUDタグ

[observability]
enabled = true
head_sampling_rate = 1 # optional. default = 1.

[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "podcast-bucket"
preview_bucket_name = "podcast-bucket-dev"  # wrangler dev 時に使用
remote = true  # wrangler dev でもリモートR2に接続

[triggers]
crons = ["*/5 * * * *"]

# Secrets (set via `wrangler secret put <NAME>`):
# - R2_ACCESS_KEY_ID
# - R2_SECRET_ACCESS_KEY
# - WEB_DEPLOY_HOOK_URL (optional: Cloudflare Pages Deploy Hook URL)
# - BLUESKY_IDENTIFIER (optional: Bluesky handle or DID for auto-posting)
# - BLUESKY_PASSWORD (optional: Bluesky app password for auto-posting)
